res.smd = var.select.smd(x = x,
y = y,
mtry = mtry,
ntree = ntree,
type = type,
s = s)
res.smd$forest$trees[[1]]
res.mir = var.select.mir(x = x,
y = y,
mtry = mtry,
ntree = ntree,
type = type,
s = s,
select.var = FALSE)
res.mir$forest$trees[[1]]
smd.i = res.smd
rel.smd = var.relations(forest = smd.i$forest, variables = smd.i$forest[["allvariables"]], candidates = smd.i$forest[["allvariables"]])
rel.smd$surr.res
library(ranger)
library(SurrogateMinimalDepth)
no.samp = 120
rep = 1000
set.seed(42)
data.all = replicate(rep, simulate_data(no.samp))
mtry = 3
ntree = 100
s = 3
type = "classification"
files.dir = set.dir(file.path(data.dir, paste0("ntree_",ntree,"_mtry_",mtry,
"_s_",s,"_rep_",rep)))
data = data.all[,,i]
x = data[,-1]
y = data[,1]
nvar=ncol(x)
res.mir = var.select.mir(x = x,
y = y,
mtry = mtry,
ntree = ntree,
type = type,
s = s,
select.var = FALSE)
saveObject(res.mir,file=file.path(files.dir,paste0("mir_",i,".RData")))
res.smd = var.select.smd(x = x,
y = y,
mtry = mtry,
ntree = ntree,
type = type,
s = s)
saveObject(res.smd,file=file.path(files.dir,paste0("smd_",i,".RData")))
res.air = ranger(data = data,
dependent.variable.name = "Y",
mtry = mtry,
num.trees = ntree,
classification = TRUE,
importance = "impurity_corrected")
saveObject(res.air,file=file.path(files.dir,paste0("air_",i,".RData")))
for (i in 1:rep) {
data = data.all[,,i]
x = data[,-1]
y = data[,1]
nvar=ncol(x)
res.mir = var.select.mir(x = x,
y = y,
mtry = mtry,
ntree = ntree,
type = type,
s = s,
select.var = FALSE)
saveObject(res.mir,file=file.path(files.dir,paste0("mir_",i,".RData")))
res.smd = var.select.smd(x = x,
y = y,
mtry = mtry,
ntree = ntree,
type = type,
s = s)
saveObject(res.smd,file=file.path(files.dir,paste0("smd_",i,".RData")))
res.air = ranger(data = data,
dependent.variable.name = "Y",
mtry = mtry,
num.trees = ntree,
classification = TRUE,
importance = "impurity_corrected")
saveObject(res.air,file=file.path(files.dir,paste0("air_",i,".RData")))
}
library(ranger)
library(SurrogateMinimalDepth)
no.samp = 120
rep = 1000
set.seed(42)
data.all = replicate(rep, simulate_data(no.samp))
mtry = 3
ntree = 100
s = 3
type = "classification"
files.dir = set.dir(file.path(data.dir, paste0("ntree_",ntree,"_mtry_",mtry,
"_s_",s,"_rep_",rep)))
for (i in 1:rep) {
data = data.all[,,i]
x = data[,-1]
y = data[,1]
nvar=ncol(x)
res.mir = var.select.mir(x = x,
y = y,
mtry = mtry,
ntree = ntree,
type = type,
s = s,
select.var = FALSE)
saveObject(res.mir,file=file.path(files.dir,paste0("mir_",i,".RData")))
res.smd = var.select.smd(x = x,
y = y,
mtry = mtry,
ntree = ntree,
type = type,
s = s)
saveObject(res.smd,file=file.path(files.dir,paste0("smd_",i,".RData")))
res.air = ranger(data = data,
dependent.variable.name = "Y",
mtry = mtry,
num.trees = ntree,
classification = TRUE,
importance = "impurity_corrected")
saveObject(res.air,file=file.path(files.dir,paste0("air_",i,".RData")))
}
rep = 400
air = matrix(NA,nrow=rep,ncol=5)
smd = matrix(NA,nrow=rep,ncol=5)
mir = matrix(NA,nrow=rep,ncol=5)
rel.smd = list()
rel.mir = list()
for (j in 1:5){
rel.smd[[j]] = matrix(NA,nrow=rep,ncol=5)
rel.mir[[j]] = matrix(NA,nrow=rep,ncol=5)
}
air.i = loadObject(file = paste0(files.dir, "/air_",i,".RData"))
air[i,] = air.i$variable.importance
smd.i = loadObject(file = paste0(files.dir, "/smd_",i,".RData"))
smd[i,] = smd.i$info$depth
i
i = 1
air.i = loadObject(file = paste0(files.dir, "/air_",i,".RData"))
air[i,] = air.i$variable.importance
smd.i = loadObject(file = paste0(files.dir, "/smd_",i,".RData"))
smd[i,] = smd.i$info$depth
air = matrix(NA,nrow=rep,ncol=11)
smd = matrix(NA,nrow=rep,ncol=11)
mir = matrix(NA,nrow=rep,ncol=11)
rel.smd = list()
rel.mir = list()
for (j in 1:5){
rel.smd[[j]] = matrix(NA,nrow=rep,ncol=11)
rel.mir[[j]] = matrix(NA,nrow=rep,ncol=11)
}
i
air.i = loadObject(file = paste0(files.dir, "/air_",i,".RData"))
air[i,] = air.i$variable.importance
smd.i = loadObject(file = paste0(files.dir, "/smd_",i,".RData"))
smd[i,] = smd.i$info$depth
smd
air
rel.smd = var.relations(forest = smd.i$forest, variables = smd.i$forest[["allvariables"]], candidates = smd.i$forest[["allvariables"]])
re.smd
rel.smd$surr.res
air = matrix(NA,nrow=rep,ncol=11)
smd = matrix(NA,nrow=rep,ncol=11)
mir = matrix(NA,nrow=rep,ncol=11)
rel.smd = list()
rel.mir = list()
for (j in 1:5){
rel.smd[[j]] = matrix(NA,nrow=rep,ncol=11)
rel.mir[[j]] = matrix(NA,nrow=rep,ncol=11)
}
rel.smd.i = var.relations(forest = smd.i$forest, variables = smd.i$forest[["allvariables"]], candidates = smd.i$forest[["allvariables"]])
rel.smd.i$surr.res[,1]
for (j in 1:11){
rel.smd[[j]] = matrix(NA,nrow=rep,ncol=11)
rel.mir[[j]] = matrix(NA,nrow=rep,ncol=11)
}
eel.smd[[1]]
rel.smd[[1]]
rel.smd.i$surr.res[,j]
j
j = 1
rel.smd.i$surr.res[,j]
rel.smd[[j]] = rel.smd.i$surr.res[,j]
rel.smd[[1]]
rel.smd
air = matrix(NA,nrow=rep,ncol=11)
smd = matrix(NA,nrow=rep,ncol=11)
mir = matrix(NA,nrow=rep,ncol=11)
rel.smd = list()
rel.mir = list()
for (j in 1:11){
rel.smd[[j]] = matrix(NA,nrow=rep,ncol=11)
rel.mir[[j]] = matrix(NA,nrow=rep,ncol=11)
}
rel.smd[[j]][,i] = rel.smd.i$surr.res[,j]
rel.smd[[j]][,i]
rel.smd[[j]][i,] = rel.smd.i$surr.res[,j]
rel.smd[[1]]
j
j = 1
rel.smd[[j]][i,] = rel.smd.i$surr.res[,j]
rel.smd
rel.smd[[1]]
rel.smd[[11]]
mir.i$info$relations$corr.maa
mir.i = loadObject(file = paste0(files.dir, "/mir_",i,".RData"))
mir.i$info$relations$corr.maa
for (i in 1:rep) {
air.i = loadObject(file = paste0(files.dir, "/air_",i,".RData"))
air[i,] = air.i$variable.importance
smd.i = loadObject(file = paste0(files.dir, "/smd_",i,".RData"))
smd[i,] = smd.i$info$depth
rel.smd.i = var.relations(forest = smd.i$forest, variables = smd.i$forest[["allvariables"]], candidates = smd.i$forest[["allvariables"]])
mir.i = loadObject(file = paste0(files.dir, "/mir_",i,".RData"))
mir[i,] = mir.i$info$MIR
for (j in 1:11) {
rel.smd[[j]][i,] = rel.smd.i$surr.res[,j]
rel.mir[[j]][i,] = mir.i$info$relations$corr.maa[,j]
}
}
smd[[1]]
smd
rel.smd[[1]]
rel.mir[[1]]
layout(matrix(c(1,2,3), 1, 3, byrow = TRUE))
par(mar = c(3,7,3,1))
boxplot(smd[,1],smd[,2],smd[,3],smd[,4],smd[,5],
ylab="Surrogate minimal depth (SMD)",main="SMD variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 1, boxwex = 0.75, cex.lab = 1.5)
boxplot(mir[,1],mir[,2],mir[,3],mir[,4],mir[,5],
ylab="Mutual impurity reduction (MIR)",main="MIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5 )
boxplot(air[,1],air[,2],air[,3],air[,4],air[,5],
ylab="Actual impurity reduction (AIR)",main="AIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5)
layout(matrix(c(1,2,3), 1, 3, byrow = TRUE))
par(mar = c(3,7,3,1))
boxplot(smd[,1],smd[,2],smd[,3],smd[,4],smd[,5],smd[,6],smd[,7],smd[,8],smd[,9],smd[,10],smd[,11],
ylab="Surrogate minimal depth (SMD)",main="SMD variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 1, boxwex = 0.75, cex.lab = 1.5)
boxplot(mir[,1],mir[,2],mir[,3],mir[,4],mir[,5],mir[,6],mir[,7],mir[,8],mir[,9],mir[,10],mir[,11],
ylab="Mutual impurity reduction (MIR)",main="MIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5 )
boxplot(air[,1],air[,2],air[,3],air[,4],air[,5],air[,6],air[,7],air[,8],air[,9],air[,10],air[,11],
ylab="Actual impurity reduction (AIR)",main="AIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5)
groupnames = c("M(2)","M(3)","M(4)","M(5)","M(6)","M(7)","M(8)","M(10)","M(20)","M(30)","N(0,1)")
layout(matrix(c(1,2,3), 1, 3, byrow = TRUE))
par(mar = c(3,7,3,1))
boxplot(smd[,1],smd[,2],smd[,3],smd[,4],smd[,5],smd[,6],smd[,7],smd[,8],smd[,9],smd[,10],smd[,11],
ylab="Surrogate minimal depth (SMD)",main="SMD variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 1, boxwex = 0.75, cex.lab = 1.5)
boxplot(mir[,1],mir[,2],mir[,3],mir[,4],mir[,5],mir[,6],mir[,7],mir[,8],mir[,9],mir[,10],mir[,11],
ylab="Mutual impurity reduction (MIR)",main="MIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5 )
boxplot(air[,1],air[,2],air[,3],air[,4],air[,5],air[,6],air[,7],air[,8],air[,9],air[,10],air[,11],
ylab="Actual impurity reduction (AIR)",main="AIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5)
groupnames = c("2","3","4","5","6","7","8","10","20","30","N")
layout(matrix(c(1,2,3), 1, 3, byrow = TRUE))
par(mar = c(3,7,3,1))
boxplot(smd[,1],smd[,2],smd[,3],smd[,4],smd[,5],smd[,6],smd[,7],smd[,8],smd[,9],smd[,10],smd[,11],
ylab="Surrogate minimal depth (SMD)",main="SMD variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 1, boxwex = 0.75, cex.lab = 1.5)
boxplot(mir[,1],mir[,2],mir[,3],mir[,4],mir[,5],mir[,6],mir[,7],mir[,8],mir[,9],mir[,10],mir[,11],
ylab="Mutual impurity reduction (MIR)",main="MIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5 )
boxplot(air[,1],air[,2],air[,3],air[,4],air[,5],air[,6],air[,7],air[,8],air[,9],air[,10],air[,11],
ylab="Actual impurity reduction (AIR)",main="AIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5)
?abline
boxplot(mir[,1],mir[,2],mir[,3],mir[,4],mir[,5],mir[,6],mir[,7],mir[,8],mir[,9],mir[,10],mir[,11],
ylab="Mutual impurity reduction (MIR)",main="MIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5 )
abline(a = 0, b = 0, col = red)
?col
boxplot(mir[,1],mir[,2],mir[,3],mir[,4],mir[,5],mir[,6],mir[,7],mir[,8],mir[,9],mir[,10],mir[,11],
ylab="Mutual impurity reduction (MIR)",main="MIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5 )
abline(a = 0, b = 0)
abline(a = 0, b = 0, col = "red")
boxplot(mir[,1],mir[,2],mir[,3],mir[,4],mir[,5],mir[,6],mir[,7],mir[,8],mir[,9],mir[,10],mir[,11],
ylab="Mutual impurity reduction (MIR)",main="MIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5 )
abline(a = 0, b = 0, col = "red", lwd = 2)
layout(matrix(c(1,2,3), 1, 3, byrow = TRUE))
par(mar = c(3,7,3,1))
boxplot(smd[,1],smd[,2],smd[,3],smd[,4],smd[,5],smd[,6],smd[,7],smd[,8],smd[,9],smd[,10],smd[,11],
ylab="Surrogate minimal depth (SMD)",main="SMD variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 1, boxwex = 0.75, cex.lab = 1.5)
boxplot(mir[,1],mir[,2],mir[,3],mir[,4],mir[,5],mir[,6],mir[,7],mir[,8],mir[,9],mir[,10],mir[,11],
ylab="Mutual impurity reduction (MIR)",main="MIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5 )
abline(a = 0, b = 0, col = "red", lwd = 3)
boxplot(air[,1],air[,2],air[,3],air[,4],air[,5],air[,6],air[,7],air[,8],air[,9],air[,10],air[,11],
ylab="Actual impurity reduction (AIR)",main="AIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5)
abline(a = 0, b = 0, col = "red", lwd = 3)
layout(matrix(c(1,2,3), 1, 3, byrow = TRUE))
par(mar = c(3,7,3,1))
boxplot(smd[,1],smd[,2],smd[,3],smd[,4],smd[,5],smd[,6],smd[,7],smd[,8],smd[,9],smd[,10],smd[,11],
ylab="Surrogate minimal depth (SMD)",main="SMD variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 1, boxwex = 0.75, cex.lab = 1.5)
boxplot(mir[,1],mir[,2],mir[,3],mir[,4],mir[,5],mir[,6],mir[,7],mir[,8],mir[,9],mir[,10],mir[,11],
ylab="Mutual impurity reduction (MIR)",main="MIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5 )
abline(a = 0, b = 0, col = "red", lwd = 2)
boxplot(air[,1],air[,2],air[,3],air[,4],air[,5],air[,6],air[,7],air[,8],air[,9],air[,10],air[,11],
ylab="Actual impurity reduction (AIR)",main="AIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5)
abline(a = 0, b = 0, col = "red", lwd = 2)
layout(matrix(c(1,2,3), 1, 3, byrow = TRUE))
par(mar = c(3,7,3,1))
boxplot(smd[,1],smd[,2],smd[,3],smd[,4],smd[,5],smd[,6],smd[,7],smd[,8],smd[,9],smd[,10],smd[,11],
ylab="Surrogate minimal depth (SMD)",main="SMD variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 1, boxwex = 0.75, cex.lab = 1.5)
boxplot(mir[,1],mir[,2],mir[,3],mir[,4],mir[,5],mir[,6],mir[,7],mir[,8],mir[,9],mir[,10],mir[,11],
ylab="Mutual impurity reduction (MIR)",main="MIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5 )
abline(a = 0, b = 0, col = "red", lwd = 1)
boxplot(air[,1],air[,2],air[,3],air[,4],air[,5],air[,6],air[,7],air[,8],air[,9],air[,10],air[,11],
ylab="Actual impurity reduction (AIR)",main="AIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5)
abline(a = 0, b = 0, col = "red", lwd = 2)
?lty
layout(matrix(c(1,2,3), 1, 3, byrow = TRUE))
par(mar = c(3,7,3,1))
boxplot(smd[,1],smd[,2],smd[,3],smd[,4],smd[,5],smd[,6],smd[,7],smd[,8],smd[,9],smd[,10],smd[,11],
ylab="Surrogate minimal depth (SMD)",main="SMD variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 1, boxwex = 0.75, cex.lab = 1.5)
boxplot(mir[,1],mir[,2],mir[,3],mir[,4],mir[,5],mir[,6],mir[,7],mir[,8],mir[,9],mir[,10],mir[,11],
ylab="Mutual impurity reduction (MIR)",main="MIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5 )
abline(a = 0, b = 0, col = "red", lwd = 2,lty = 3)
boxplot(air[,1],air[,2],air[,3],air[,4],air[,5],air[,6],air[,7],air[,8],air[,9],air[,10],air[,11],
ylab="Actual impurity reduction (AIR)",main="AIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5)
abline(a = 0, b = 0, col = "red", lwd = 2, lty = 3)
layout(matrix(c(1,2,3), 1, 3, byrow = TRUE))
par(mar = c(3,7,3,1))
boxplot(smd[,1],smd[,2],smd[,3],smd[,4],smd[,5],smd[,6],smd[,7],smd[,8],smd[,9],smd[,10],smd[,11],
ylab="Surrogate minimal depth (SMD)",main="SMD variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 1, boxwex = 0.75, cex.lab = 1.5)
boxplot(mir[,1],mir[,2],mir[,3],mir[,4],mir[,5],mir[,6],mir[,7],mir[,8],mir[,9],mir[,10],mir[,11],
ylab="Mutual impurity reduction (MIR)",main="MIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5 )
abline(a = 0, b = 0, col = "red", lwd = 2,lty = 2)
boxplot(air[,1],air[,2],air[,3],air[,4],air[,5],air[,6],air[,7],air[,8],air[,9],air[,10],air[,11],
ylab="Actual impurity reduction (AIR)",main="AIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5)
abline(a = 0, b = 0, col = "red", lwd = 2, lty = 2)
layout(matrix(c(1,2,3), 1, 3, byrow = TRUE))
par(mar = c(3,7,3,1))
boxplot(smd[,1],smd[,2],smd[,3],smd[,4],smd[,5],smd[,6],smd[,7],smd[,8],smd[,9],smd[,10],smd[,11],
ylab="Surrogate minimal depth (SMD)",main="SMD variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 1, boxwex = 0.75, cex.lab = 1.5)
boxplot(mir[,1],mir[,2],mir[,3],mir[,4],mir[,5],mir[,6],mir[,7],mir[,8],mir[,9],mir[,10],mir[,11],
ylab="Mutual impurity reduction (MIR)",main="MIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5 )
abline(a = 0, b = 0, col = "red", lwd = 3,lty = 2)
boxplot(air[,1],air[,2],air[,3],air[,4],air[,5],air[,6],air[,7],air[,8],air[,9],air[,10],air[,11],
ylab="Actual impurity reduction (AIR)",main="AIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5)
abline(a = 0, b = 0, col = "red", lwd = 3, lty = 2)
layout(matrix(c(1,2,3), 1, 3, byrow = TRUE))
par(mar = c(3,7,3,1))
boxplot(smd[,1],smd[,2],smd[,3],smd[,4],smd[,5],smd[,6],smd[,7],smd[,8],smd[,9],smd[,10],smd[,11],
ylab="Surrogate minimal depth (SMD)",main="SMD variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 1, boxwex = 0.75, cex.lab = 1.5)
boxplot(mir[,1],mir[,2],mir[,3],mir[,4],mir[,5],mir[,6],mir[,7],mir[,8],mir[,9],mir[,10],mir[,11],
ylab="Mutual impurity reduction (MIR)",main="MIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5 )
abline(a = 0, b = 0, col = "red", lwd = 2,lty = 6)
boxplot(air[,1],air[,2],air[,3],air[,4],air[,5],air[,6],air[,7],air[,8],air[,9],air[,10],air[,11],
ylab="Actual impurity reduction (AIR)",main="AIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5)
abline(a = 0, b = 0, col = "red", lwd = 2, lty = 6)
layout(matrix(c(1,2,3), 1, 3, byrow = TRUE))
par(mar = c(3,7,3,1))
boxplot(smd[,1],smd[,2],smd[,3],smd[,4],smd[,5],smd[,6],smd[,7],smd[,8],smd[,9],smd[,10],smd[,11],
ylab="Surrogate minimal depth (SMD)",main="SMD variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 1, boxwex = 0.75, cex.lab = 1.5)
boxplot(mir[,1],mir[,2],mir[,3],mir[,4],mir[,5],mir[,6],mir[,7],mir[,8],mir[,9],mir[,10],mir[,11],
ylab="Mutual impurity reduction (MIR)",main="MIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5 )
abline(a = 0, b = 0, col = "red", lwd = 2,lty = 4)
boxplot(air[,1],air[,2],air[,3],air[,4],air[,5],air[,6],air[,7],air[,8],air[,9],air[,10],air[,11],
ylab="Actual impurity reduction (AIR)",main="AIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5)
abline(a = 0, b = 0, col = "red", lwd = 2, lty = 4)
layout(matrix(c(1,2,3), 1, 3, byrow = TRUE))
par(mar = c(3,7,3,1))
boxplot(smd[,1],smd[,2],smd[,3],smd[,4],smd[,5],smd[,6],smd[,7],smd[,8],smd[,9],smd[,10],smd[,11],
ylab="Surrogate minimal depth (SMD)",main="SMD variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 1, boxwex = 0.75, cex.lab = 1.5)
boxplot(mir[,1],mir[,2],mir[,3],mir[,4],mir[,5],mir[,6],mir[,7],mir[,8],mir[,9],mir[,10],mir[,11],
ylab="Mutual impurity reduction (MIR)",main="MIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5 )
abline(a = 0, b = 0, col = "red", lwd = 2,lty = 1)
boxplot(air[,1],air[,2],air[,3],air[,4],air[,5],air[,6],air[,7],air[,8],air[,9],air[,10],air[,11],
ylab="Actual impurity reduction (AIR)",main="AIR variable importance",names=groupnames
,col = "lightgray", pch = 19, cex = 0.75, boxwex = 0.75, cex.lab = 1.5)
abline(a = 0, b = 0, col = "red", lwd = 2, lty = 1)
boxplot(rel.smd[[1]][,2])
boxplot(rel.smd[[1]][,1],rel.smd[[1]][,2],rel.smd[[1]][,3],rel.smd[[1]][,4],rel.smd[[1]][,5],rel.smd[[1]][,6],rel.smd[[1]][,7],rel.smd[[1]][,8],rel.smd[[1]][,9],rel.smd[[1]][,10],rel.smd[[1]][,11])
z = 4
boxplot(rel.smd[[z]][,1],rel.smd[[z]][,2],rel.smd[[z]][,3],rel.smd[[z]][,4],rel.smd[[z]][,5],rel.smd[[z]][,6],rel.smd[[z]][,7],rel.smd[[z]][,8],rel.smd[[z]][,9],rel.smd[[z]][,10],rel.smd[[z]][,11])
dev.off()
z = 11
boxplot(rel.smd[[z]][,1],rel.smd[[z]][,2],rel.smd[[z]][,3],rel.smd[[z]][,4],rel.smd[[z]][,5],rel.smd[[z]][,6],rel.smd[[z]][,7],rel.smd[[z]][,8],rel.smd[[z]][,9],rel.smd[[z]][,10],rel.smd[[z]][,11])
z = 11
rel = rel.mir
boxplot(rel[[z]][,1],rel[[z]][,2],rel[[z]][,3],rel[[z]][,4],rel[[z]][,5],rel[[z]][,6],rel[[z]][,7],rel[[z]][,8],rel[[z]][,9],rel[[z]][,10],rel[[z]][,11])
z = 5
rel = rel.mir
boxplot(rel[[z]][,1],rel[[z]][,2],rel[[z]][,3],rel[[z]][,4],rel[[z]][,5],rel[[z]][,6],rel[[z]][,7],rel[[z]][,8],rel[[z]][,9],rel[[z]][,10],rel[[z]][,11])
z = 5
rel = rel.smd
boxplot(rel[[z]][,1],rel[[z]][,2],rel[[z]][,3],rel[[z]][,4],rel[[z]][,5],rel[[z]][,6],rel[[z]][,7],rel[[z]][,8],rel[[z]][,9],rel[[z]][,10],rel[[z]][,11])
z = 1
rel = rel.smd
boxplot(rel[[z]][,1],rel[[z]][,2],rel[[z]][,3],rel[[z]][,4],rel[[z]][,5],rel[[z]][,6],rel[[z]][,7],rel[[z]][,8],rel[[z]][,9],rel[[z]][,10],rel[[z]][,11])
z = 1
rel = rel.mir
boxplot(rel[[z]][,1],rel[[z]][,2],rel[[z]][,3],rel[[z]][,4],rel[[z]][,5],rel[[z]][,6],rel[[z]][,7],rel[[z]][,8],rel[[z]][,9],rel[[z]][,10],rel[[z]][,11])
boxplot(rel[[z]][,1],rel[[z]][,2],rel[[z]][,3],rel[[z]][,4],rel[[z]][,5],rel[[z]][,6],rel[[z]][,7],rel[[z]][,8],rel[[z]][,9],rel[[z]][,10],rel[[z]][,11])
z = 1
rel = rel.smd
boxplot(rel[[z]][,1],rel[[z]][,2],rel[[z]][,3],rel[[z]][,4],rel[[z]][,5],rel[[z]][,6],rel[[z]][,7],rel[[z]][,8],rel[[z]][,9],rel[[z]][,10],rel[[z]][,11])
z = 1
rel = rel.smd
boxplot(rel[[z]][,1],rel[[z]][,2],rel[[z]][,3],rel[[z]][,4],rel[[z]][,5],rel[[z]][,6],rel[[z]][,7],rel[[z]][,8],rel[[z]][,9],rel[[z]][,10],rel[[z]][,11],ylab =c(0,0.05))
z = 1
rel = rel.smd
boxplot(rel[[z]][,1],rel[[z]][,2],rel[[z]][,3],rel[[z]][,4],rel[[z]][,5],rel[[z]][,6],rel[[z]][,7],rel[[z]][,8],rel[[z]][,9],rel[[z]][,10],rel[[z]][,11],ylim =c(0,0.05))
z = 1
rel = rel.smd
boxplot(rel[[z]][,1],rel[[z]][,2],rel[[z]][,3],rel[[z]][,4],rel[[z]][,5],rel[[z]][,6],rel[[z]][,7],rel[[z]][,8],rel[[z]][,9],rel[[z]][,10],rel[[z]][,11],ylim =c(0,0.1))
boxplot(rel[[z]][,1],rel[[z]][,2],rel[[z]][,3],rel[[z]][,4],rel[[z]][,5],rel[[z]][,6],rel[[z]][,7],rel[[z]][,8],rel[[z]][,9],rel[[z]][,10],rel[[z]][,11],ylim =c(0,0.05))
z = 1
rel = rel.mir
boxplot(rel[[z]][,1],rel[[z]][,2],rel[[z]][,3],rel[[z]][,4],rel[[z]][,5],rel[[z]][,6],rel[[z]][,7],rel[[z]][,8],rel[[z]][,9],rel[[z]][,10],rel[[z]][,11])
z = 1
rel = rel.mir
boxplot(rel[[z]][,1],rel[[z]][,2],rel[[z]][,3],rel[[z]][,4],rel[[z]][,5],rel[[z]][,6],rel[[z]][,7],rel[[z]][,8],rel[[z]][,9],rel[[z]][,10],rel[[z]][,11],ylim =c(0,0.05))
z = 1
rel = rel.smd
boxplot(rel[[z]][,1],rel[[z]][,2],rel[[z]][,3],rel[[z]][,4],rel[[z]][,5],rel[[z]][,6],rel[[z]][,7],rel[[z]][,8],rel[[z]][,9],rel[[z]][,10],rel[[z]][,11],ylim =c(0,0.05))
rep = 1000
for (i in 445:rep) {
data = data.all[,,i]
x = data[,-1]
y = data[,1]
nvar=ncol(x)
res.mir = var.select.mir(x = x,
y = y,
mtry = mtry,
ntree = ntree,
type = type,
s = s,
select.var = FALSE)
saveObject(res.mir,file=file.path(files.dir,paste0("mir_",i,".RData")))
res.smd = var.select.smd(x = x,
y = y,
mtry = mtry,
ntree = ntree,
type = type,
s = s)
saveObject(res.smd,file=file.path(files.dir,paste0("smd_",i,".RData")))
res.air = ranger(data = data,
dependent.variable.name = "Y",
mtry = mtry,
num.trees = ntree,
classification = TRUE,
importance = "impurity_corrected")
saveObject(res.air,file=file.path(files.dir,paste0("air_",i,".RData")))
}
library(SurrogateMinimalDepth)
devtools::document()
library(SurrogateMinimalDepth)
air = matrix(NA,nrow=rep,ncol=11)
smd = matrix(NA,nrow=rep,ncol=11)
mir = matrix(NA,nrow=rep,ncol=11)
rel.smd = list()
rel.mir = list()
for (j in 1:11){
rel.smd[[j]] = matrix(NA,nrow=rep,ncol=11)
rel.mir[[j]] = matrix(NA,nrow=rep,ncol=11)
}
for (i in 1:rep) {
air.i = loadObject(file = paste0(files.dir, "/air_",i,".RData"))
air[i,] = air.i$variable.importance
smd.i = loadObject(file = paste0(files.dir, "/smd_",i,".RData"))
smd[i,] = smd.i$info$depth
rel.smd.i = var.relations(forest = smd.i$forest, variables = smd.i$forest[["allvariables"]], candidates = smd.i$forest[["allvariables"]])
mir.i = loadObject(file = paste0(files.dir, "/mir_",i,".RData"))
mir[i,] = mir.i$info$MIR
for (j in 1:11) {
rel.smd[[j]][i,] = rel.smd.i$surr.res[,j]
rel.mir[[j]][i,] = mir.i$info$relations$corr.maa[,j]
}
}
rep
library(blockForest)
?blockfor
?blockForest
library(Pomona)
?var.sel.boruta
library(ranger)
?ranger
